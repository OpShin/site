(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[46],{8740:function(s,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user-manual/smart_contract_tour/common_design_patterns",function(){return n(3946)}])},3946:function(s,e,n){"use strict";n.r(e),n.d(e,{__toc:function(){return c}});var o=n(5893),i=n(2673),r=n(2197),l=n(8426);n(9128);var t=n(2643),a=n(9013);let c=[{depth:2,value:"Enforcing Uniqueness",id:"enforcing-uniqueness"},{depth:3,value:'"One-Shot" Minting Policies',id:"one-shot-minting-policies"},{depth:3,value:"Receipts",id:"receipts"},{depth:3,value:"Unique Outputs",id:"unique-outputs"},{depth:4,value:"Problem: Double Satisfaction",id:"problem-double-satisfaction"},{depth:4,value:"Solution: Tagged Outputs",id:"solution-tagged-outputs"},{depth:2,value:"State Thread Tokens (a.k.a STT)",id:"state-thread-tokens-aka-stt"},{depth:2,value:"Forwarding Validation & Other Withdrawal Tricks",id:"forwarding-validation--other-withdrawal-tricks"},{depth:2,value:"Going further",id:"going-further"},{depth:3,value:"Anastasia Labs' design patterns",id:"anastasia-labs-design-patterns"},{depth:3,value:"Plutonomicon",id:"plutonomicon"}];function _createMdxContent(s){let e=Object.assign({h1:"h1",p:"p",h2:"h2",h3:"h3",code:"code",pre:"pre",span:"span",h4:"h4",em:"em",ol:"ol",li:"li",ul:"ul",blockquote:"blockquote",a:"a"},(0,t.a)(),s.components);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h1,{children:"Common Design Patterns"}),"\n",(0,o.jsx)(e.p,{children:"There are number of design patterns that have been refined and enabled as Plutus has advanced from V1 to V2,\nand now to V3. This document seeks to be a non-exhaustive reference to these design patterns and practices."}),"\n",(0,o.jsx)(e.h2,{id:"enforcing-uniqueness",children:"Enforcing Uniqueness"}),"\n",(0,o.jsx)(e.p,{children:"Enforcing the uniqueness of policies, asset names, or new outputs is useful in a number of contexts."}),"\n",(0,o.jsx)(e.h3,{id:"one-shot-minting-policies",children:'"One-Shot" Minting Policies'}),"\n",(0,o.jsxs)(e.p,{children:["A validator is parameterized with an ",(0,o.jsx)(e.code,{children:"OutputReference"}),", the minting validator\nenforces that the inputs to the transaction contain the corresponding ",(0,o.jsx)(e.code,{children:"UTxO"})," as\ninput. By doing this, the minting policy is ensured to only validate once and\nonly once (since an unspent transaction output can only be spent once, by\ndefinition). In some designs, this logic is used for only a subset of redeemers\nto allow more flexible minting policies."]}),"\n",(0,o.jsx)(e.p,{children:"Let's walk through an example."}),"\n",(0,o.jsx)(e.p,{children:"An NFT (Non-Fungible Token) can be created using a one-shot minting policy that\nensures each minted value is validated by spending a specific UTxO provided\nthrough the transaction inputs. This minting policy uses a validator parameter\nof OutputReference to confirm that the transaction spends the UTxO.\nAdditionally, the policy guarantees that only one token is minted, ensuring the\nNFT's uniqueness."}),"\n",(0,o.jsx)(e.p,{children:"First define OutputReference as parameter and set the action type to mint or\nburn the token based on the value provided in the redeemer."}),"\n",(0,o.jsx)(e.pre,{"data-language":"python","data-theme":"default",hasCopyCode:!0,children:(0,o.jsxs)(e.code,{"data-language":"python","data-theme":"default",children:[(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" dataclasses "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" dataclass"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" typing "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Union"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" opshin"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"prelude "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"@dataclass"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"MintingAction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"PlutusData"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    CONSTR_ID "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"@dataclass"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"BurningAction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"PlutusData"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    CONSTR_ID "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Action "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Union"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"MintingAction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" BurningAction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"validator"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"utxo_ref"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" TxOutRef"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ScriptContext) "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"->"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isinstance"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(context.purpose, Minting),"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Minting policy expected"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    redeemer"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Action "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"redeemer"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"# Minting and burning rules will follow after this"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    ..."})})]})}),"\n",(0,o.jsx)(e.p,{children:"The validator must handle minting/burning operations and ensures that only one value is minted; it will fail otherwise."}),"\n",(0,o.jsx)(e.pre,{"data-language":"python","data-theme":"default",hasCopyCode:!0,children:(0,o.jsxs)(e.code,{"data-language":"python","data-theme":"default",children:[(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" dataclasses "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" dataclass"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" typing "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Union"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" opshin"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"prelude "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"@dataclass"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"MintingAction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"PlutusData"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    CONSTR_ID "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"@dataclass"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"BurningAction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"PlutusData"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    CONSTR_ID "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Action "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Union"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"MintingAction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" BurningAction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"validator"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"utxo_ref"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" TxOutRef"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ScriptContext) "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"->"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    purpose "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"purpose"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isinstance"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose, Minting),"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Minting policy expected"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    redeemer"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Action "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"redeemer"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"# Minting and burning rules follow after this"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    minted_for_policy"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"TokenName"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"transaction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"mint"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        purpose.policy_id, {}"})}),"\n",(0,o.jsx)(e.span,{className:"line",children:(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    )"})}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    minted_assets "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"list"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(minted_for_policy."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"items"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"())"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"len"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(minted_assets)"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Mint exactly one asset for this policy"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    _token_name"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" minted_assets"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"# Checking the UTxO consumption happens in the next step."})]})]})}),"\n",(0,o.jsxs)(e.p,{children:["To enforce uniqueness, we need to ensure that the UTxO defined as OutputReference in the validator parameters is\nconsumed. This is because every OutputReference is a unique combination of the Transaction ID and an Output Index\nInteger. It's important to remember that the Transaction ID is a ",(0,o.jsx)(e.code,{children:"Hash<Blake2b_256, Transaction>"}),", which is also a\nunique identifier and will not be repeated."]}),"\n",(0,o.jsx)(e.pre,{"data-language":"python","data-theme":"default",hasCopyCode:!0,children:(0,o.jsxs)(e.code,{"data-language":"python","data-theme":"default",children:[(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" dataclasses "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" dataclass"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" typing "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Union"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" opshin"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"prelude "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"@dataclass"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"MintingAction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"PlutusData"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    CONSTR_ID "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"@dataclass"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"BurningAction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"PlutusData"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    CONSTR_ID "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Action "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Union"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"MintingAction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" BurningAction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"validator"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"utxo_ref"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" TxOutRef"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ScriptContext) "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"->"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    purpose "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"purpose"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isinstance"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose, Minting),"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Minting policy expected"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    redeemer"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Action "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"redeemer"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"# Minting and burning rules follow after this"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    minted_for_policy"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"TokenName"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"transaction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"mint"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        purpose.policy_id, {"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"b"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"}"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    )"})}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    minted_assets "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" minted_for_policy"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"items"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"len"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(minted_assets)"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Mint exactly one asset for this policy"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    token_name"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" minted_assets"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    consumed_refs "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" [tx_in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"out_ref "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"transaction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"inputs]"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isinstance"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(redeemer, MintingAction):"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" utxo_ref "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" consumed_refs"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Required UTxO was not consumed"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Mint a single token"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"-"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Burn a single token"'})]})]})}),"\n",(0,o.jsx)(e.h3,{id:"receipts",children:"Receipts"}),"\n",(0,o.jsxs)(e.p,{children:["A validator can mint a unique receipt for a transaction by requiring that the name of the asset is any\nunique value specific to the transaction where validation is set to occur. In other words, if we enforce\nthat only one receipt is to be minted per transaction, we can use ",(0,o.jsx)(e.code,{children:"blake2b_256"})," and ",(0,o.jsx)(e.code,{children:"cbor.serialise"})," to\nget a unique value that can be assigned to the ",(0,o.jsx)(e.code,{children:"AssetName"})," expected for the receipt from the\n",(0,o.jsx)(e.code,{children:"OutputReference"})," from the first ",(0,o.jsx)(e.code,{children:"Input"})," in our transactions inputs."]}),"\n",(0,o.jsx)(e.pre,{"data-language":"python","data-theme":"default",hasCopyCode:!0,children:(0,o.jsxs)(e.code,{"data-language":"python","data-theme":"default",children:[(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" hashlib "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" blake2b"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" typing "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" opshin"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"prelude "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"validator"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ScriptContext) "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"->"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    purpose "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"purpose"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isinstance"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose, Minting),"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Minting policy expected"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    tx_info "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"transaction"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    first_input "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_info"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"inputs"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    minted_for_policy"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"TokenName"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_info"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"mint"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose.policy_id, {"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"b"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"})"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    minted_assets "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" minted_for_policy"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"items"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"len"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(minted_assets)"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Mint exactly one receipt token"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    asset_name"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" minted_assets"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    expected_name "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"blake2b"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        first_input.out_ref."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"to_cbor"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    )."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"digest"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" asset_name "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" expected_name"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Derived token name mismatch"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Receipt must mint a single token"'})]})]})}),"\n",(0,o.jsx)(e.p,{children:"We could use this validator to mint a unique receipt for a transaction. It will get the first UTxO reference\nand will compare it with the asset name."}),"\n",(0,o.jsx)(e.h3,{id:"unique-outputs",children:"Unique Outputs"}),"\n",(0,o.jsx)(e.h4,{id:"problem-double-satisfaction",children:"Problem: Double Satisfaction"}),"\n",(0,o.jsxs)(e.p,{children:["To prevent a vulnerability called ",(0,o.jsx)(e.em,{children:"'Double Satisfaction'"})," (see more below), one\nmust ensure that outputs associated with a given input are only counted once\nacross all possible validations occuring in a transaction."]}),"\n",(0,o.jsx)(e.p,{children:"In the eUTxO model, a common anti-pattern is to predicate spending upon logic\nthat is specific to a given input - without ensuring the uniqueness of the\ncorresponding output."}),"\n",(0,o.jsx)(e.p,{children:"Let's walk through a short example: Bob wants to sell 20 SCOIN and wants at\nleast 5 ADA in return; the contract would require that at least 5 ADA is paid\nto Bob."}),"\n",(0,o.jsx)(e.p,{children:"Step-by-step swap:"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"Bob sends 20 SCOIN to the validator with a datum containing his\nVerificationKeyHash and the price (5 ADA) required to get the 20 SCOIN."}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"Alice makes a new transaction getting the 20 SCOIN and paying 5 ADA to Bob."}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"Alice will get 20 SCOIN."}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:"Bob will get 5 ADA."}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.pre,{"data-language":"python","data-theme":"default",hasCopyCode:!0,children:(0,o.jsxs)(e.code,{"data-language":"python","data-theme":"default",children:[(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" dataclasses "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" dataclass"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" typing "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" List"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" opshin"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"prelude "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"lovelace_of"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"value"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"PolicyId"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"TokenName"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]]"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"->"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" value"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"b"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:", {"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"b"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:": "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"})."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"b"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:", "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"@dataclass"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"DatumSwap"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"PlutusData"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    beneficiary"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" PubKeyHash"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    price"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"# ! DANGER: exploitable"})}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"validator"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ScriptContext) "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"->"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    purpose "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"purpose"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isinstance"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose, Spending),"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Spending purpose expected"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    datum"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" DatumSwap "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"own_datum_unsafe"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(context)"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    beneficiary_address "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Address"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"PubKeyCredential"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(datum.beneficiary), "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"NoStakingCredential"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    )"})}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    payments"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" List"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"TxOut"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        tx_out"})}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"transaction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"outputs"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"address "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" beneficiary_address"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    ]"})}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    total_paid "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"sum"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"lovelace_of"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(tx_out.value) "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:" tx_out "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:" payments])"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" total_paid "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:">="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" datum"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"price"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Insufficient payment"'})]})]})}),"\n",(0,o.jsx)(e.p,{children:"So far, everything is ok, but what if we have some UTxOs locked in the\nvalidator at similar prices?"}),"\n",(0,o.jsx)(e.p,{children:"Bob wants to sell 20 XCOIN, and 20 SCOIN and wants at least 10 ADA in return\nfor each UTxO; the contract would require that at least 10 ADA be paid to Bob.\nNow Alice comes and pays Bob 10 ADA, in the same transaction she takes both the\n20 SCOIN and 20 XCOIN because the contract only ensures that at least 10 ADA is\npaid to Bob."}),"\n",(0,o.jsx)(e.p,{children:"So, this validator could potentially cause be satisfied twice with the same\ninputs, where anyone can pay once and get every UTxO unlocked at the same price\nor less."}),"\n",(0,o.jsx)(e.h4,{id:"solution-tagged-outputs",children:"Solution: Tagged Outputs"}),"\n",(0,o.jsx)(e.p,{children:"What can we do? We have to ensure that each input has a corresponding unique\noutput to pay or predicate the logic of spending any input of the script on all\nof the inputs and outputs relevant to the business logic of the dApp."}),"\n",(0,o.jsx)(e.p,{children:"In addition, we have to remember that the code in the validator will be\nexecuted for every UTxO locked by the validator that we are trying to spend\nfrom. So we have to make sure that outputs aren't counted multiple times across\nmultiple executions of the validator (for each input validation)."}),"\n",(0,o.jsxs)(e.p,{children:["This can be achieved by ",(0,o.jsx)(e.em,{children:"tagging"})," outputs with a value which is unique to the\ninput. Enough information is present in the ",(0,o.jsx)(e.code,{children:"OutputReference"})," of the input to\ncreate a unique tag that must then be found in outputs."]}),"\n",(0,o.jsx)(e.pre,{"data-language":"python","data-theme":"default",hasCopyCode:!0,children:(0,o.jsxs)(e.code,{"data-language":"python","data-theme":"default",children:[(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" typing "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" List"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" opshin"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"prelude "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"lovelace_of"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"value"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"PolicyId"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"TokenName"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]]"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"->"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" value"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"b"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:", {"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"b"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:": "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"})."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"b"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:", "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"@dataclass"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"class"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"DatumSwap"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"PlutusData"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"):"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    beneficiary"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" PubKeyHash"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    price"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"validator"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ScriptContext) "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"->"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    purpose "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"purpose"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isinstance"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose, Spending),"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Spending purpose expected"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    datum"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" DatumSwap "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"own_datum_unsafe"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(context)"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    beneficiary_address "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"Address"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"PubKeyCredential"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(datum.beneficiary), "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"NoStakingCredential"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    )"})}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    tagged_outputs"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" List"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"TxOut"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" []"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"transaction"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"outputs"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"address "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" beneficiary_address"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            output_datum "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"datum"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isinstance"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(output_datum, SomeOutputDatum):"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                datum_value "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" output_datum"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"datum"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"# Soft-cast: ignore unrelated outputs instead of aborting the transaction."})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" datum_value "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" purpose"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"tx_out_ref"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"                    tagged_outputs "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" [tx_out] "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"+"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tagged_outputs"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    total_paid "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"sum"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"lovelace_of"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(tx_out.value) "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:" tx_out "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:" tagged_outputs])"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" total_paid "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:">="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" datum"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"price"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Tagged payment too small"'})]})]})}),"\n",(0,o.jsx)(e.h2,{id:"state-thread-tokens-aka-stt",children:"State Thread Tokens (a.k.a STT)"}),"\n",(0,o.jsx)(e.p,{children:"It is often useful to have a mutable state which either changes with each transaction, or on a periodic\nbasis. One way to ensure that a datum is not 'spoofed' is to ensure that the input or reference input with\nthat datum contains an NFT which has been generated to be unique using one of the method described above."}),"\n",(0,o.jsx)(e.p,{children:"In this example, we will create an STT that tracks the sum of every transaction\nthat uses the STT. And for this, we will create a multivalidator with two\nresponsabilities: a minting and spending policy."}),"\n",(0,o.jsx)(e.p,{children:"The STT Minting Policy allows us to create new tokens with a counter datum initialized at 0."}),"\n",(0,o.jsx)(e.pre,{"data-language":"python","data-theme":"default",hasCopyCode:!0,children:(0,o.jsxs)(e.code,{"data-language":"python","data-theme":"default",children:[(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" typing "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" opshin"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"prelude "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"EMPTY_VALUE"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"bytes"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"{}"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"validator"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"utxo_ref"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" TxOutRef"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"operator"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" PubKeyHash"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ScriptContext) "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"->"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    purpose "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"purpose"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    tx_info "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"transaction"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isinstance"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose, Minting):"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        minted_for_policy"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"TokenName"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_info"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"mint"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose.policy_id, EMPTY_VALUE)"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        minted_assets "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" minted_for_policy"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"items"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"()"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"len"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(minted_assets)"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Mint exactly one STT token"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        token_name"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" minted_assets"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Mint a single STT"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        consumed_refs "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" [tx_in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"out_ref "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_info"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"inputs]"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" utxo_ref "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" consumed_refs"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Authorising reference missing"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        stt_outputs "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            tx_out"})}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_info"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"outputs"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"value"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose.policy_id, EMPTY_VALUE)."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(token_name, "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        ]"})}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"len"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(stt_outputs)"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"STT must be forwarded exactly once"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        datum"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"resolve_datum_unsafe"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(stt_outputs["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"], tx_info)"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" datum "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Initial counter must be zero"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"elif"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isinstance"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose, Spending):"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"# The spending branch is implemented below."})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"pass"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"False"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Unsupported script purpose"'})]})]})}),"\n",(0,o.jsx)(e.pre,{"data-language":"python","data-theme":"default",hasCopyCode:!0,children:(0,o.jsxs)(e.code,{"data-language":"python","data-theme":"default",children:[(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" typing "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Optional"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" opshin"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"prelude "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"*"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"def"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"validator"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"utxo_ref"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" TxOutRef"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"operator"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" PubKeyHash"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-parameter)"},children:"context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ScriptContext) "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"->"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    purpose "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"purpose"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    tx_info "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" context"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"transaction"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isinstance"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose, Minting):"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        minted_for_policy"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Dict"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"TokenName"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_info"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"mint"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose.policy_id, {})"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        minted_assets "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"list"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(minted_for_policy."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"items"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"())"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"len"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(minted_assets)"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Mint exactly one STT token"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        token_name"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" minted_assets"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Mint a single STT"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        consumed_refs "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" [tx_in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"out_ref "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_info"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"inputs]"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" utxo_ref "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" consumed_refs"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Authorising reference missing"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        stt_outputs "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            tx_out"})}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_info"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"outputs"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"value"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose.policy_id, {})."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(token_name, "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        ]"})}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"len"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(stt_outputs)"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"STT must be forwarded exactly once"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        datum "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"resolve_datum_unsafe"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(stt_outputs["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"], tx_info)"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isinstance"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(datum, "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"),"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Counter datum must be an integer"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" datum "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Initial counter must be zero"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"isinstance"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(purpose, Spending),"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Supported purposes are minting and spending only"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    own_utxo "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"own_spent_utxo"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(tx_info.inputs, purpose)"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    own_policy "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"own_policy_id"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(own_utxo)"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" operator "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_info"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"signatories"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Operator signature missing"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    stt_input"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Optional"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"TxInInfo"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"None"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_info"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"inputs"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"sum"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(tx_in.resolved.value."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(own_policy, {})."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"values"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"())"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            stt_input "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_in"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"break"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" stt_input "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"is"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"not"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"STT input not found"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    input_datum"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"resolve_datum_unsafe"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(stt_input.resolved, tx_info)"})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    stt_output"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" Optional"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"["}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"TxOut"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"]"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"None"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_info"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"outputs"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"sum"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(tx_out.value."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(own_policy, {})."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"values"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"())"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" quantity "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"0"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            stt_output "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" tx_out"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"            "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"break"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" stt_output "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"is"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"not"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"None"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"STT must be forwarded"'})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" stt_input"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"resolved"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"address "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" stt_output"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"."}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"address"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"STT address mismatch"'})]}),"\n",(0,o.jsx)(e.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    output_datum"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"int"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"resolve_datum_unsafe"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(stt_output, tx_info)"})]}),"\n",(0,o.jsxs)(e.span,{className:"line",children:[(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"assert"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" output_datum "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" input_datum "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"+"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"1"}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Counter must increment by one"'})]})]})}),"\n",(0,o.jsx)(e.p,{children:"Here is the part of the validator that ensures every transaction increments the value of the counter:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"We check if the transaction is signed by the operator."}),"\n",(0,o.jsx)(e.li,{children:"We recover the minting policy identifier from the spending input so we can locate the STT."}),"\n",(0,o.jsx)(e.li,{children:"We check if an input NFT exists and has a datum with an integer."}),"\n",(0,o.jsx)(e.li,{children:"We check if an output exists and has a datum with an integer."}),"\n",(0,o.jsx)(e.li,{children:"We check if the output datum equals the input datum + 1."}),"\n"]}),"\n",(0,o.jsx)(a.UW,{type:"info",children:(0,o.jsxs)(e.p,{children:["When compiling the script you can pass the operator public key hash as a parameter (for example via ",(0,o.jsx)(e.code,{children:"--force-three-params"})," in the Opshin CLI). This keeps the key configurable without hard-coding it in the contract."]})}),"\n",(0,o.jsx)(e.h2,{id:"forwarding-validation--other-withdrawal-tricks",children:"Forwarding Validation & Other Withdrawal Tricks"}),"\n",(0,o.jsxs)(e.p,{children:["By enforcing withdrawals from a specific given script, we can effectively\n'forward' the validation to this script being evaluated with the ",(0,o.jsx)(e.code,{children:"withdraw"}),"\nscript purpose. This is possible in particular because it is always possible to\nwithdraw an amount of 0 lovelace."]}),"\n",(0,o.jsx)(e.p,{children:"We can leverage this to allow a script to be owner of one or multiple UTxOs\nthemselves locked by a much simpler script. In stead of normally ensuring that\nthe owner's PKH is present in the required signatories, we use a small script\nthat forward the validation to another single script also present in the\ntransaction."}),"\n",(0,o.jsx)(e.p,{children:"By using this trick in a spending validator, we can reduce the overhead that\ncomes from authorizing multiple spending. Indeed, instead of running the same\nbunch of logic multiple times (one for each input), we only run it once for the\nwithdrawal script. Since validators have access to the entire transaction as a\ncontext, regardless of their execution purpose, it is feasible most of the\ntime."}),"\n",(0,o.jsx)(e.p,{children:"This is being used by a number of dApps now in production in order to optimize\nevaluation budgets and reach a higher efficiency."}),"\n",(0,o.jsx)(e.h2,{id:"going-further",children:"Going further"}),"\n",(0,o.jsx)(e.h3,{id:"anastasia-labs-design-patterns",children:"Anastasia Labs' design patterns"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.a,{href:"https://github.com/Anastasia-Labs/design-patterns",children:"https://github.com/Anastasia-Labs/design-patterns"})}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"A library designed to abstract away some of the more unintuitive and\nlesser-known eUTxO design patterns, making them more accessible to developers."}),"\n",(0,o.jsx)(e.h3,{id:"plutonomicon",children:"Plutonomicon"}),"\n",(0,o.jsxs)(e.blockquote,{children:["\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.a,{href:"https://github.com/Plutonomicon/plutonomicon",children:"https://github.com/Plutonomicon/plutonomicon"})}),"\n"]}),"\n",(0,o.jsxs)(e.p,{children:["A developer-driven guide to the Plutus smart contract platform ",(0,o.jsx)(e.em,{children:"in practice"}),"."]}),"\n",(0,o.jsx)(a.UW,{type:"info",children:(0,o.jsxs)(e.p,{children:["This page is adapted from the ",(0,o.jsx)(e.a,{href:"https://github.com/aiken-lang/site/blob/main/src/pages/fundamentals/common-design-patterns.mdx",children:"Aiken documentation"}),", where you can find the same patterns written in aiken."]})})]})}let h={MDXContent:function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,t.a)(),s.components);return e?(0,o.jsx)(e,{...s,children:(0,o.jsx)(_createMdxContent,{...s})}):_createMdxContent(s)},pageOpts:{filePath:"src/pages/user-manual/smart_contract_tour/common_design_patterns.mdx",route:"/user-manual/smart_contract_tour/common_design_patterns",timestamp:176234276e4,pageMap:[{kind:"Meta",data:{index:{title:"OpShin",type:"page",display:"hidden",theme:{layout:"raw"}},"user-manual":{title:"Documentation",type:"page",href:"/user-manual/introduction"},playground:{title:"Playground",type:"page",href:"https://playground.opshin.dev"},credits:{title:"About",display:"hidden",theme:{breadcrumb:!1,footer:!0,sidebar:!1,toc:!1,pagination:!1}}}},{kind:"MdxPage",name:"index",route:"/",frontMatter:{title:"Cardano Smart Contracts in Python"}},{kind:"Folder",name:"user-manual",route:"/user-manual",children:[{kind:"Meta",data:{index:"Introduction",getting_started:"Getting Started",eutxo_crash_course:"Understanding EUTXO",language_tour:{title:"Language Tour"},smart_contract_tour:{title:"Smart Contract Tour"},common_issues:"Common Issues",additional_resources:"Additional Resources",what_i_wish_i_knew:"What I Wish I Knew"}},{kind:"MdxPage",name:"additional_resources",route:"/user-manual/additional_resources"},{kind:"MdxPage",name:"common_issues",route:"/user-manual/common_issues"},{kind:"MdxPage",name:"eutxo_crash_course",route:"/user-manual/eutxo_crash_course"},{kind:"MdxPage",name:"getting_started",route:"/user-manual/getting_started"},{kind:"MdxPage",name:"index",route:"/user-manual",frontMatter:{title:"Introduction"}},{kind:"Folder",name:"language_tour",route:"/user-manual/language_tour",children:[{kind:"Meta",data:{index:"Overview",structure:"Structure",primitive_types:"Primitive Types",container_types:"Container Types",classes:"Classes",variables:"Variables",conditional_statements:"Conditional Statements",loop_statements:"Loop Statements",functions:"Functions",builtins:"Builtins",stdlib:{title:"Standard Library",type:"page",href:"https://opshin.opshin.dev/opshin/std/index.html",newWindow:!0}}},{kind:"MdxPage",name:"builtins",route:"/user-manual/language_tour/builtins"},{kind:"MdxPage",name:"classes",route:"/user-manual/language_tour/classes"},{kind:"MdxPage",name:"conditional_statements",route:"/user-manual/language_tour/conditional_statements"},{kind:"MdxPage",name:"container_types",route:"/user-manual/language_tour/container_types"},{kind:"MdxPage",name:"functions",route:"/user-manual/language_tour/functions"},{kind:"MdxPage",name:"index",route:"/user-manual/language_tour"},{kind:"MdxPage",name:"loop_statements",route:"/user-manual/language_tour/loop_statements"},{kind:"MdxPage",name:"primitive_types",route:"/user-manual/language_tour/primitive_types"},{kind:"MdxPage",name:"structure",route:"/user-manual/language_tour/structure"},{kind:"MdxPage",name:"variables",route:"/user-manual/language_tour/variables"}]},{kind:"Folder",name:"smart_contract_tour",route:"/user-manual/smart_contract_tour",children:[{kind:"Meta",data:{index:"Overview",validator_scripts:"Validator Scripts",the_scriptcontext:"The ScriptContext",handling_time:"Handling Time",migration_v3:"Migrating to PlutusV3",common_design_patterns:"Common Design Patterns",advanced:"Advanced Topics",what_i_wish_i_knew:"What I Wish I Knew",ledger_def:{title:"Ledger Definitions",type:"page",href:"https://opshin.opshin.dev/opshin/ledger/index.html",newWindow:!0},examples:{title:"Examples",type:"page",href:"https://github.com/OpShin/awesome-opshin/#examples",newWindow:!0}}},{kind:"MdxPage",name:"advanced",route:"/user-manual/smart_contract_tour/advanced"},{kind:"MdxPage",name:"common_design_patterns",route:"/user-manual/smart_contract_tour/common_design_patterns"},{kind:"MdxPage",name:"handling_time",route:"/user-manual/smart_contract_tour/handling_time"},{kind:"MdxPage",name:"index",route:"/user-manual/smart_contract_tour"},{kind:"MdxPage",name:"migration_v3",route:"/user-manual/smart_contract_tour/migration_v3"},{kind:"MdxPage",name:"the_scriptcontext",route:"/user-manual/smart_contract_tour/the_scriptcontext"},{kind:"MdxPage",name:"validator_scripts",route:"/user-manual/smart_contract_tour/validator_scripts"}]},{kind:"MdxPage",name:"what_i_wish_i_knew",route:"/user-manual/what_i_wish_i_knew"}]}],flexsearch:{codeblocks:!0},readingTime:{text:"11 min read",minutes:10.6,time:636e3,words:2120},title:"Common Design Patterns",headings:c},pageNextRoute:"/user-manual/smart_contract_tour/common_design_patterns",nextraLayout:r.ZP,themeConfig:l.Z};e.default=(0,i.j)(h)},8426:function(s,e,n){"use strict";var o=n(5893),i=n(5379),r=n.n(i),l=n(2197),t=n(2010);let a={logo:()=>{let{resolvedTheme:s}=(0,t.F)();return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("img",{style:{height:"var(--nextra-navbar-height)"},src:"light"===s?"/logo-dark.png":"/logo.png"})})},head:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("link",{rel:"icon",type:"image/x-icon",href:"/favicon.ico"}),(0,o.jsx)("meta",{name:"twitter:image",content:"https://opshin.dev/open-graph.jpg"}),(0,o.jsx)("meta",{name:"twitter:site:domain",content:"opshin.dev"})]}),project:{link:"https://github.com/opshin"},chat:{link:"https://discord.com/invite/umR3A2g4uw"},search:{placeholder:"Search the docs...",emptyResult:null,error:"",loading:null},toc:{extraContent:(0,o.jsx)(o.Fragment,{})},i18n:[{locale:"en",text:"English"}],docsRepositoryBase:"https://github.com/opshin/site/blob/main",useNextSeoProps(){let{title:s}=(0,l.ZR)(),e="Cardano Smart Contracts in Python";return{titleTemplate:"OpShin | %s",description:e,canonical:"https://opshin.dev/",openGraph:{url:"https://opshin.dev/",description:e,images:[{url:"https://opshin.dev/open-graph.jpg",width:800,height:418,alt:"OpShin - Cardano Smart Contracts in Python",type:"image/jpg"}]},siteName:"OpShin",twitter:{handle:"@OpShinDev",site:"https://opshin.dev",cardType:"summary_large_image"}}},footer:{component:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("footer",{className:"jsx-111148e9a1b1c3f",children:[(0,o.jsxs)("aside",{className:"jsx-111148e9a1b1c3f",children:[(0,o.jsx)("img",{src:"/typo.webp",className:"jsx-111148e9a1b1c3f"}),(0,o.jsx)("p",{className:"jsx-111148e9a1b1c3f",children:"Build without limits"})]}),(0,o.jsxs)("nav",{className:"jsx-111148e9a1b1c3f",children:[(0,o.jsxs)("h2",{className:"jsx-111148e9a1b1c3f",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",className:"jsx-111148e9a1b1c3f",children:[(0,o.jsx)("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",className:"jsx-111148e9a1b1c3f"}),(0,o.jsx)("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",className:"jsx-111148e9a1b1c3f"})]})," Quick Links"]}),(0,o.jsxs)("ul",{className:"jsx-111148e9a1b1c3f",children:[(0,o.jsx)("li",{className:"jsx-111148e9a1b1c3f",children:(0,o.jsx)("a",{href:"https://github.com/OpShin/opshin-starter-kit",className:"jsx-111148e9a1b1c3f",children:"Starter Kit"})}),(0,o.jsx)("li",{className:"jsx-111148e9a1b1c3f",children:(0,o.jsx)("a",{href:"https://github.com/OpShin/opshin-pioneer-program",className:"jsx-111148e9a1b1c3f",children:"Pioneer Program"})}),(0,o.jsx)("li",{className:"jsx-111148e9a1b1c3f",children:(0,o.jsx)("a",{href:"https://opshin.opshin.dev/opshin/",className:"jsx-111148e9a1b1c3f",children:"Docs"})})]})]}),(0,o.jsxs)("nav",{className:"jsx-111148e9a1b1c3f",children:[(0,o.jsxs)("h2",{className:"jsx-111148e9a1b1c3f",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",className:"jsx-111148e9a1b1c3f",children:(0,o.jsx)("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z",className:"jsx-111148e9a1b1c3f"})}),"Community"]}),(0,o.jsxs)("ul",{className:"jsx-111148e9a1b1c3f",children:[(0,o.jsx)("li",{className:"jsx-111148e9a1b1c3f",children:(0,o.jsx)("a",{href:"https://discord.com/invite/umR3A2g4uw",className:"jsx-111148e9a1b1c3f",children:"Discord"})}),(0,o.jsx)("li",{className:"jsx-111148e9a1b1c3f",children:(0,o.jsx)("a",{href:"https://twitter.com/OpShinDev",className:"jsx-111148e9a1b1c3f",children:"Twitter"})}),(0,o.jsx)("li",{className:"jsx-111148e9a1b1c3f",children:(0,o.jsx)("a",{href:"https://github.com/OpShin",className:"jsx-111148e9a1b1c3f",children:"GitHub"})}),(0,o.jsx)("li",{className:"jsx-111148e9a1b1c3f",children:(0,o.jsx)("a",{href:"https://patreon.com/OpShin",className:"jsx-111148e9a1b1c3f",children:"Patreon"})})]})]}),(0,o.jsxs)("nav",{className:"jsx-111148e9a1b1c3f",children:[(0,o.jsxs)("h2",{className:"jsx-111148e9a1b1c3f",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",className:"jsx-111148e9a1b1c3f",children:[(0,o.jsx)("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2",className:"jsx-111148e9a1b1c3f"}),(0,o.jsx)("circle",{cx:"9",cy:"7",r:"4",className:"jsx-111148e9a1b1c3f"}),(0,o.jsx)("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87",className:"jsx-111148e9a1b1c3f"}),(0,o.jsx)("path",{d:"M16 3.13a4 4 0 0 1 0 7.75",className:"jsx-111148e9a1b1c3f"})]}),"Partners"]}),(0,o.jsxs)("ul",{className:"jsx-111148e9a1b1c3f",children:[(0,o.jsx)("li",{className:"jsx-111148e9a1b1c3f",children:(0,o.jsx)("a",{href:"https://emurgo.io/",className:"jsx-111148e9a1b1c3f",children:"Emurgo"})}),(0,o.jsx)("li",{className:"jsx-111148e9a1b1c3f",children:(0,o.jsx)("a",{href:"https://inversion.dev",className:"jsx-111148e9a1b1c3f",children:"Inversion.Dev"})}),(0,o.jsx)("li",{className:"jsx-111148e9a1b1c3f",children:(0,o.jsx)("a",{href:"https://muesliswap.com",className:"jsx-111148e9a1b1c3f",children:"MuesliSwap"})})]})]})]}),(0,o.jsx)(r(),{id:"111148e9a1b1c3f",children:"footer.jsx-111148e9a1b1c3f{background:#0067b4;color:#fff;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin:0 auto;padding:2rem 12.5vw}footer.jsx-111148e9a1b1c3f aside.jsx-111148e9a1b1c3f{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;font-variant:small-caps;font-size:.75em}footer.jsx-111148e9a1b1c3f aside.jsx-111148e9a1b1c3f p.jsx-111148e9a1b1c3f{padding:0 .15rem}footer.jsx-111148e9a1b1c3f aside.jsx-111148e9a1b1c3f img.jsx-111148e9a1b1c3f{width:4rem;height:auto}@media(max-width:1e3px){footer.jsx-111148e9a1b1c3f{padding:2rem 5%}}@media(max-width:600px){footer.jsx-111148e9a1b1c3f{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}footer.jsx-111148e9a1b1c3f aside.jsx-111148e9a1b1c3f+nav.jsx-111148e9a1b1c3f,footer.jsx-111148e9a1b1c3f nav.jsx-111148e9a1b1c3f+nav.jsx-111148e9a1b1c3f{margin-top:1rem}}footer.jsx-111148e9a1b1c3f nav.jsx-111148e9a1b1c3f{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}footer.jsx-111148e9a1b1c3f nav.jsx-111148e9a1b1c3f h2.jsx-111148e9a1b1c3f{font-weight:bold;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;margin-bottom:.35rem}footer.jsx-111148e9a1b1c3f nav.jsx-111148e9a1b1c3f h2.jsx-111148e9a1b1c3f>svg.jsx-111148e9a1b1c3f{width:1em;height:auto;margin-right:.5rem}footer.jsx-111148e9a1b1c3f nav.jsx-111148e9a1b1c3f ul.jsx-111148e9a1b1c3f{font-size:.9em}"})]})}};e.Z=a},5789:function(){}},function(s){s.O(0,[774,915,888,179],function(){return s(s.s=8740)}),_N_E=s.O()}]);